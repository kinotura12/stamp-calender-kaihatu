/* role: styles (moved from index.html) */

    :root{
      --bg:#0f1115;
      --surface-1:#171a21;
      --surface-2:#1c2028;
      --surface-3:rgba(255,255,255,.03);
      --border-subtle:rgba(255,255,255,.06);
      --border-strong:rgba(255,255,255,.12);

      --text-strong:#e8ecf3;
      --text-normal:#d8dde6;
      --text-muted:#a9b2c3;
      --text-mini:#8f9ab1;
      --text: var(--text-strong);  /* legacy */
      --muted: var(--text-muted);  /* legacy */

      --shadow-sm: 0 4px 10px rgba(0,0,0,.25);
      --shadow-md: 0 12px 30px rgba(0,0,0,.35);
      --shadow-lg: 0 18px 44px rgba(0,0,0,.5);
      --shadow-stamp: 0 6px 16px rgba(0,0,0,.35);
      --shadow-card: var(--shadow-md);
      --shadow-popover: var(--shadow-lg);

      --input-bg: rgba(0,0,0,.18);
      --input-border: rgba(255,255,255,.10);
      --input-shadow: var(--shadow-sm);
      --box-bg: rgba(0,0,0,.18);
      --box-border: rgba(255,255,255,.10);
      --box-shadow: var(--shadow-sm);

      --btn-bg: rgba(255,255,255,.06);
      --btn-fg: #e8ecf3;
      --btn-border: rgba(255,255,255,.12);
      --btn-shadow: var(--shadow-sm);
      --btn-danger-bg: rgba(255,120,120,.12);
      --btn-danger-border: rgba(255,140,140,.25);
      --btn-danger-fg: #ffc8c8;
      --btn-danger-shadow: var(--shadow-sm);

      --pill-bg: rgba(255,255,255,.06);
      --pill-border: rgba(255,255,255,.12);
      --pill-fg: rgba(232,236,243,.85);

      --accent:#62c7ff;
      --accent-2:#ff6fae;
      --success:#6ee38b;
      --warning:#ffd55a;
      --danger:#ff6b6b;
      --info:#4a9ded;
      --link:#4a9ded;

      --ring: rgba(255,255,255,.16);

      /* palette (残す) */
      --pink:#ff6fae;
      --orange:#ff9a4a;
      --yellow:#ffd55a;
      --green:#6ee38b;
      --blue:#62c7ff;

      /* legacy mappings */
      --panel: var(--surface-1);
      --card: var(--surface-2);
      --card2: var(--surface-3);
      --card-border: var(--border-subtle);
      --card-shadow: var(--shadow-card);
    }
    :root[data-ui-theme="ui_dark_default"]{
      --bg:#0f1115;
      --surface-1:#171a21;
      --surface-2:#1c2028;
      --surface-3:rgba(255,255,255,.03);
      --border-subtle:rgba(255,255,255,.06);
      --border-strong:rgba(255,255,255,.12);

      --text-strong:#e8ecf3;
      --text-normal:#d8dde6;
      --text-muted:#a9b2c3;
      --text-mini:#8f9ab1;
      --text: var(--text-strong);
      --muted: var(--text-muted);

      --shadow-sm: 0 4px 10px rgba(0,0,0,.25);
      --shadow-md: 0 12px 30px rgba(0,0,0,.35);
      --shadow-lg: 0 18px 44px rgba(0,0,0,.5);
      --shadow-stamp: 0 6px 16px rgba(0,0,0,.35);
      --shadow-card: var(--shadow-md);
      --shadow-popover: var(--shadow-lg);

      --input-bg: rgba(0,0,0,.18);
      --input-border: rgba(255,255,255,.10);
      --input-shadow: var(--shadow-sm);
      --box-bg: rgba(0,0,0,.18);
      --box-border: rgba(255,255,255,.10);
      --box-shadow: var(--shadow-sm);

      --btn-bg: rgba(255,255,255,.06);
      --btn-fg: #e8ecf3;
      --btn-border: rgba(255,255,255,.12);
      --btn-shadow: var(--shadow-sm);
      --btn-danger-bg: rgba(255,120,120,.12);
      --btn-danger-border: rgba(255,140,140,.25);
      --btn-danger-fg: #ffc8c8;
      --btn-danger-shadow: var(--shadow-sm);

      --pill-bg: rgba(255,255,255,.06);
      --pill-border: rgba(255,255,255,.12);
      --pill-fg: rgba(232,236,243,.85);

      --accent:#62c7ff;
      --accent-2:#ff6fae;
      --success:#6ee38b;
      --warning:#ffd55a;
      --danger:#ff6b6b;
      --info:#4a9ded;
      --link:#4a9ded;

      --ring: rgba(255,255,255,.16);

      --pink:#ff6fae;
      --orange:#ff9a4a;
      --yellow:#ffd55a;
      --green:#6ee38b;
      --blue:#62c7ff;

      --panel: var(--surface-1);
      --card: var(--surface-2);
      --card2: var(--surface-3);
      --card-border: var(--border-subtle);
      --card-shadow: var(--shadow-card);
    }
    :root[data-ui-theme="ui_light_default"]{
      --bg:#f5f6fb;
      --surface-1:#ffffff;
      --surface-2:#ffffff;
      --surface-3:rgba(0,0,0,.02);
      --border-subtle: rgba(0,0,0,.08);
      --border-strong: rgba(0,0,0,.15);

      --text-strong:#1d2433;
      --text-normal:#2d3342;
      --text-muted:#63708a;
      --text-mini:#7a869c;
      --text: var(--text-strong);
      --muted: var(--text-muted);

      --shadow-sm: 0 4px 10px rgba(0,0,0,.08);
      --shadow-md: 0 8px 20px rgba(0,0,0,.08);
      --shadow-lg: 0 12px 26px rgba(0,0,0,.14);
      --shadow-stamp: 0 6px 14px rgba(0,0,0,.18);
      --shadow-card: var(--shadow-md);
      --shadow-popover: var(--shadow-lg);

      --input-bg: #ffffff;
      --input-border: rgba(0,0,0,.08);
      --input-shadow: var(--shadow-sm);
      --box-bg: #ffffff;
      --box-border: rgba(0,0,0,.08);
      --box-shadow: var(--shadow-sm);
      --btn-bg: #f3f7fb;
      --btn-fg: #3a4558;
      --btn-border: rgba(0,0,0,.08);
      --btn-shadow: var(--shadow-sm);
      --btn-danger-bg: #ffe8e8;
      --btn-danger-border: rgba(220,70,70,.25);
      --btn-danger-fg: #b03030;
      --btn-danger-shadow: 0 4px 10px rgba(0,0,0,.12);
      --pill-bg: rgba(58,69,88,.06);
      --pill-border: rgba(58,69,88,.15);
      --pill-fg: rgba(58,69,88,.85);

      --accent:#4a9ded;
      --accent-2:#e0569c;
      --success:#46b86f;
      --warning:#e9ba3c;
      --danger:#e06b6b;
      --info:#4a9ded;
      --link:#4a9ded;

      --ring: rgba(0,0,0,.08);
      --pink:#e0569c;
      --orange:#ff8a3c;
      --yellow:#e9ba3c;
      --green:#46b86f;
      --blue:#4a9ded;

      --panel: var(--surface-1);
      --card: var(--surface-2);
      --card2: var(--surface-3);
      --card-border: var(--border-subtle);
      --card-shadow: var(--shadow-card);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif;
      background: radial-gradient(1100px 700px at 20% 0%, color-mix(in srgb, var(--accent) 30%, var(--bg)) 0%, var(--bg) 60%);
      color: var(--text-strong);
      -webkit-tap-highlight-color: transparent;
    }
    :root[data-ui-theme="ui_light_default"] body{
      background: var(--bg);
      color: var(--text-strong);
    }

    header{
      position: sticky;
      top: 0;
      z-index: 20;
      backdrop-filter: blur(10px);
      background: color-mix(in srgb, var(--bg) 65%, transparent);
      border-bottom: 1px solid var(--border-subtle);
    }

    .wrap{
      max-width: 820px;
      margin: 0 auto;
      padding: 14px 14px 40px;
    }

    .titleRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      padding: 10px 0 8px;
    }

    .monthNav{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }

    .navBtn{
      width: 36px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 16px;
      line-height: 1;
      box-shadow: var(--btn-shadow);
    }
    .navBtn:active{ transform: translateY(1px); }
    .navBtn[disabled]{ opacity: .35; cursor: default; transform:none; }

    h1{
      margin:0;
      font-size: 18px;
      letter-spacing: .02em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .sub{
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }

    .rightBar{
      display:flex;
      gap:8px;
      align-items:center;
      flex: 0 0 auto;
    }

    /* ハンバーガー */
    .hamburger{
      width: 38px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 4px;
      cursor:pointer;
      box-shadow: var(--btn-shadow);
      color: var(--btn-fg);
    }
    .hamburger span{
      width: 16px;
      height: 2px;
      background: currentColor;
      border-radius: 2px;
    }
    .hamburger:active{ transform: translateY(1px); }

    /* ===== calendar header row (dow) ===== */
    .dow{
      display:grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      margin-top: 10px;
      padding: 10px 10px 0;
      color: var(--muted);
      font-size: 12px;
      text-align:center;
    }

    .grid{
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 10px;
      margin-top: 8px;
      box-shadow: var(--card-shadow);
    }
    :root{
      --fab-inset: 48px;
    }
    .fab{
      position: fixed;
      left: 0;
      bottom: var(--fab-inset);
      width: 54px;
      height: 54px;
      border-radius: 999px;
      border: 2px solid var(--ring);
      background: var(--fab-color, var(--pink));
      color: color-mix(in srgb, var(--surface-2) 80%, transparent);
      box-shadow: var(--shadow-stamp);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor: pointer;
      --fab-ty: 0px;
      --fab-scale: 1;
      transform: translateX(0) translateY(var(--fab-ty)) scale(var(--fab-scale));
      transition: transform .2s ease;
      z-index: 40;
    }
    .fab.is-pressing{
      --fab-ty: 4px;
      --fab-scale: 1.04;
    }
    .fabIcon{
      font-size: 26px;
      line-height: 1;
      font-weight: 600;
    }
    .fabBubble{
      position: fixed;
      z-index: 45;
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 10px 12px 12px;
      border-radius: 14px;
      background: var(--card);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-md);
      min-width: 220px;
      --bubble-ty: 0px;
      --bubble-scale: 1;
      transform: translateY(var(--bubble-ty)) scale(var(--bubble-scale));
      transition: transform .2s ease, opacity .3s ease;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    .fabBubble.show{
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }
    .fabBubble.is-hiding{
      opacity: 0;
      pointer-events: none;
    }
    .fabBubble.is-pressing{
      --bubble-ty: 3px;
      --bubble-scale: 1;
    }
    .fabBubble::after{
      content: "";
      position: absolute;
      width: 12px;
      height: 12px;
      left: var(--fab-bubble-caret-x, 50%);
      bottom: -6px;
      margin-left: -6px;
      background: var(--card);
      border-left: 1px solid var(--card-border);
      border-top: 1px solid var(--card-border);
      transform: rotate(45deg);
    }
    .fabMemoBubble{
      position: fixed;
      z-index: 46;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding: 12px;
      border-radius: 14px;
      background: var(--card);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-md);
      min-width: 240px;
      --bubble-ty: 0px;
      --bubble-scale: 1;
      transform: translateY(var(--bubble-ty)) scale(var(--bubble-scale));
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity .3s ease, transform .18s ease;
    }
    .fabMemoBubble.is-attention{
      --bubble-scale: 1.03;
    }
    .fabMemoBubble::after{
      content: "";
      position: absolute;
      width: 12px;
      height: 12px;
      left: var(--fab-memo-caret-x, 50%);
      bottom: -6px;
      margin-left: -6px;
      background: var(--card);
      border-left: 1px solid var(--card-border);
      border-top: 1px solid var(--card-border);
      transform: rotate(45deg);
    }
    .fabMemoBubble.show{
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }
    .fabMemoHead{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 8px;
      position: relative;
    }
    .fabMemoTitle{
      font-size: 12px;
      color: var(--text-normal);
      letter-spacing: .02em;
      text-align: center;
      flex: 1 1 auto;
    }
    .fabMemoClose{
      width: 30px;
      height: 30px;
      border-radius: 999px;
      padding: 0;
      position: absolute;
      top: -16px;
      right: -16px;
      z-index: 2;
    }
    .fabMemoClose{
      border: 1px solid var(--btn-danger-border);
      background: var(--btn-danger-bg);
      box-shadow: var(--btn-danger-shadow);
      color: color-mix(in srgb, var(--btn-danger-border) 60%, var(--btn-danger-fg) 40%);
      border-radius: 999px;
    }
    .fabMemoClose svg{
      width: 14px !important;
      height: 14px !important;
    }
    .fabMemoInput{
      width: 100%;
      min-height: 72px;
      resize: vertical;
      border-radius: 12px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text-strong);
      padding: 10px;
      font-size: 14px;
      box-shadow: var(--input-shadow);
    }
    .fabMemoInput:focus{
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent) 30%, transparent), var(--input-shadow);
    }
    .fabMemoSave{
      width: 100%;
    }
    .fabBubbleTitle{
      font-size: 12px;
      color: var(--text-normal);
      text-align: center;
      letter-spacing: .02em;
    }
    .fabBubbleRow{
      display:flex;
      gap: 10px;
      justify-content: space-between;
    }
    .fabPick{
      width: var(--stamp-l);
      height: var(--stamp-l);
      border-radius: 999px;
      border: 2px solid var(--ring);
      box-shadow: var(--shadow-stamp);
      cursor: pointer;
      --pick-ty: 0px;
      --pick-scale: 1;
      transform: translateY(var(--pick-ty)) scale(var(--pick-scale));
      transition: transform .2s ease, opacity .12s ease;
    }
    .fabPick.is-pressing{
      --pick-ty: 3px;
      --pick-scale: 1.04;
    }

    @media (hover: hover) and (pointer: fine){
      .fab:hover{ --fab-scale: 1.06; }
      .fabPick:hover{ --pick-scale: 1.1; }
    }
    @media (max-width: 640px){
      :root{ --fab-inset: 36px; }
    }
    @media (prefers-reduced-motion: reduce){
      .fab{ transition: none; }
    }

    .days{
      display:grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      padding: 10px 0 0;
    }

    /* ===== calendar cell ===== */
    .cell{
      position: relative;
      border-radius: 14px;
      border: 1px solid var(--border-subtle);
      background: var(--card2);
      padding: 8px;
      cursor: pointer;
      overflow: hidden;
      user-select: none;
      height: 86px;
    }
    .cell.empty{
      opacity: .25;
      cursor: default;
    }
    .cell.selected{
      outline: 2px solid color-mix(in srgb, var(--ring) 70%, transparent);
      background: color-mix(in srgb, var(--surface-3) 60%, transparent);
    }

    .daynum{
      font-size: 12px;
      color: var(--muted);
      line-height: 1;
    }

    .goalPreview{
      margin-top: 6px;
      font-size: 12px;
      font-weight: 800;
      letter-spacing: .01em;
      color: var(--text-normal);
      padding-right: 30px;
      display: none;
    }
    .goalPreview.show{
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .goalPreview.empty{
      opacity: .25;
      font-weight: 600;
    }

    /* ===== stamp dot in calendar cell ===== */
    .dot{
      position:absolute;
      right: 8px;
      bottom: 8px;
      width: var(--stamp-m);
      height: var(--stamp-m);
      border-radius: 999px;
      border: 2px solid var(--ring);
      background: transparent;
      cursor: pointer;
      transition: transform .08s ease;
    }
    .dot:active{ transform: scale(.95); }
    .dot.filled{ border-color: var(--ring); box-shadow: var(--shadow-sm); }
    .dot.pink{ background: var(--pink); }
    .dot.orange{ background: var(--orange); }
    .dot.yellow{ background: var(--yellow); }
    .dot.green{ background: var(--green); }
    .dot.blue{ background: var(--blue); }

    /* ===== color picker popup (with title) ===== */
    .picker{
      position: fixed;
      z-index: 9999;
      display: none;
      flex-direction: column;
      gap: 10px;
      padding: 10px 12px 12px;
      border-radius: 14px;
      background: var(--card);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-popover);
      backdrop-filter: blur(10px);
      min-width: 190px;
    }
    .picker.show{ display:flex; }

    .pickerTitle{
      font-size: 12px;
      color: var(--text-normal);
      letter-spacing: .02em;
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .pickerTitle .miniDot{
      width: 10px; height: 10px;
      border-radius: 999px;
      border: 2px solid var(--ring);
      opacity: .85;
    }

    .pickerRow{
      display:flex;
      gap: 10px;
      justify-content: space-between;
    }

    .pick{
      width: var(--stamp-m);
      height: var(--stamp-m);
      border-radius: 999px;
      border: 2px solid var(--ring);
      box-shadow: var(--shadow-md);
      cursor: pointer;
      transition: transform .08s ease, opacity .12s ease;
    }
    .pick:active{ transform: translateY(1px) scale(.98); }
    .pick.pink{ background: var(--pink); }
    .pick.orange{ background: var(--orange); }
    .pick.yellow{ background: var(--yellow); }
    .pick.green{ background: var(--green); }
    .pick.blue{ background: var(--blue); }
    .shape-circle{ border-radius: 999px !important; clip-path: none; }
    .shape-rounded{ border-radius: 10px !important; clip-path: none; }
    .shape-diamond{ border-radius: 0 !important; clip-path: polygon(50% 0,100% 50%,50% 100%,0 50%); }
    .stampImg{
      width: 100%;
      height: 100%;
      object-fit: contain;
      display:block;
      border-radius: inherit;
      pointer-events: none;
      filter: drop-shadow(0 2px 4px color-mix(in srgb, var(--bg) 70%, transparent));
    }

    .caret{
      position: fixed;
      z-index: 9998;
      width: 10px; height: 10px;
      background: var(--card);
      border-left: 1px solid var(--card-border);
      border-top: 1px solid var(--card-border);
      transform: rotate(45deg);
      display:none;
      box-shadow: var(--shadow-popover);
      backdrop-filter: blur(10px);
    }
    .caret.show{ display:block; }

    /* ===== theme picker ===== */
    .themeOverlay{
      position: fixed;
      inset: 0;
      background: color-mix(in srgb, var(--bg) 65%, transparent);
      backdrop-filter: blur(4px);
      display:none;
      z-index: 80;
    }
    .themeOverlay.show{ display:block; }

    .themePanel{
      position: fixed;
      inset: 0;
      margin: auto;
      width: min(70vw, 640px);
      max-width: 640px;
      max-height: 90vh;
      background: color-mix(in srgb, var(--panel) 94%, transparent);
      border: 1px solid var(--border-strong);
      border-radius: 18px;
      box-shadow: var(--shadow-popover);
      padding: 14px;
      display:none;
      z-index: 90;
      overflow: hidden;
    }
    .themePanel.show{ display:flex; flex-direction:column; }
    .themeHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }
    .themeTitle{ font-size: 16px; font-weight: 800; }
    .themeSub{ font-size: 12px; color: var(--muted); margin-top: 4px; }
    .themeGrid{
      margin-top: 12px;
      display:flex;
      flex-direction:column;
      gap: 12px;
      overflow-y: auto;
      padding: 4px;
      flex: 1 1 auto;
    }
    .themeSectionTitle{
      font-size: 12px;
      color: var(--text-muted);
      margin: 8px 0 4px;
      letter-spacing: .02em;
    }
    .themeCard{
      border-radius: 14px;
      border: 1px solid var(--card-border);
      background: var(--card);
      padding: 12px;
      cursor:pointer;
      transition: border-color .12s ease, transform .12s ease;
      display:flex;
      flex-direction:column;
      gap: 10px;
      box-shadow: var(--card-shadow);
      color: var(--text-normal);
    }
    .themeCard:hover{ border-color: color-mix(in srgb, var(--accent) 70%, transparent); transform: translateY(-1px); }
    .themeCard.selected{
      border-color: var(--accent);
      box-shadow: var(--shadow-md);
    }
    .themeThumb{
      border-radius: 12px;
      height: 220px;
      width: 100%;
      background: var(--panel, var(--card));
      position: relative;
      overflow: hidden;
      border: 1px solid var(--card-border);
      flex: 0 0 auto;
      padding: 10px;
      box-sizing: border-box;
      display:flex;
      flex-direction:column;
      gap: 8px;
    }
    .themeThumb .thumbHeader{
      height: 22px;
      border-radius: 10px;
      background: var(--surface-2);
      display:flex;
      align-items:center;
      justify-content:flex-start;
      padding: 0 8px;
      font-size: 11px;
      color: var(--text-strong);
      gap: 6px;
    }
    .thumbHeaderBtn{
      width: 18px;
      height: 18px;
      border-radius: 6px;
      border: 1px solid var(--card-border);
      background: var(--btn-bg);
      color: var(--text-strong);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 12px;
      box-shadow: var(--btn-shadow);
      flex: 0 0 auto;
    }
    .thumbHeaderTitle{
      flex: 0 0 auto;
      min-width: 82px;
      text-align: center;
      padding: 0 6px;
    }
    .themeThumb .thumbBody{
      display:flex;
      gap: 10px;
      align-items:flex-start;
      flex: 1 1 auto;
      overflow:hidden;
    }
    .thumbCalendar{
      flex: 0 0 40%;
      background: var(--surface-1);
      border: 1px solid var(--card-border);
      border-radius: 12px;
      padding: 8px;
      box-shadow: var(--shadow-sm);
      display:flex;
      flex-direction:column;
      gap: 6px;
    }
    .thumbCalRow{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 4px;
    }
    .thumbDay{
      background: var(--surface-2);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      padding: 6px 6px 10px;
      position: relative;
      height: 44px;
      box-shadow: inset 0 0 0 1px var(--border-subtle);
    }
    .thumbDay.selected{
      border-color: var(--accent);
      box-shadow: var(--shadow-sm);
    }
    .thumbDayDate{
      font-size: 10px;
      font-weight: 700;
      color: var(--text-strong);
      line-height: 1;
    }
    .thumbDayStamp{
      width: 14px;
      height: 14px;
      border-radius: 999px;
      background: var(--pink);
      position: absolute;
      right: 6px;
      bottom: 6px;
      box-shadow: var(--shadow-sm);
      border: 2px solid var(--card-border);
    }
    .thumbContent{
      flex: 1 1 auto;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 12px;
      box-shadow: var(--card-shadow);
      padding: 10px;
      display:flex;
      flex-direction:column;
      gap: 8px;
    }
    .thumbDiaryCard{
      background: var(--surface-2);
      border: 1px solid var(--card-border);
      border-radius: 10px;
      box-shadow: inset 0 0 0 1px var(--border-subtle);
      padding: 8px;
      display:flex;
      flex-direction:column;
      gap: 6px;
      flex: 1 1 auto;
    }
    .thumbDiaryTop{
      display:flex;
      align-items:center;
      gap: 8px;
      font-size: 10px;
      color: var(--text-strong);
      font-weight: 700;
    }
    .thumbDiaryStamp{
      width: 14px;
      height: 14px;
      border-radius: 999px;
      background: var(--pink);
      border: 2px solid var(--card-border);
      box-shadow: var(--shadow-sm);
    }
    .thumbMoodRow{
      display:flex;
      gap: 6px;
    }
    .thumbMoodDot{
      width: 12px;
      height: 12px;
      border-radius: 999px;
      background: var(--pink);
      box-shadow: var(--shadow-sm);
    }
    .thumbMoodDot.orange{ background: var(--orange); }
    .thumbMoodDot.yellow{ background: var(--yellow); }
    .thumbMoodDot.green{ background: var(--green); }
    .thumbMoodDot.blue{ background: var(--blue); }
    .thumbField{
      border-radius: 8px;
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      box-shadow: var(--input-shadow);
      padding: 6px 8px;
      font-size: 10px;
      color: var(--text-normal);
    }
    .thumbTodoList{
      display:flex;
      flex-direction:column;
      gap: 6px;
    }
    .thumbTodoRow{
      display:flex;
      align-items:center;
      gap: 6px;
    }
    .thumbTodoCheck{
      width: 14px;
      height: 14px;
      border-radius: 4px;
      border: 1px solid var(--card-border);
      background: var(--surface-3);
      box-shadow: inset 0 0 0 1px var(--border-subtle);
      position: relative;
      flex: 0 0 auto;
    }
    .thumbTodoCheck.checked{
      background: var(--accent);
      border-color: var(--accent);
      box-shadow: var(--shadow-sm);
    }
    .thumbTodoCheck.checked::after{
      content: "";
      position: absolute;
      inset: 3px;
      border: 2px solid var(--text-strong);
      border-top: none;
      border-left: none;
      transform: rotate(45deg);
      border-radius: 1px;
    }
    .thumbTodo{
      border-radius: 6px;
      background: var(--surface-3);
      border: 1px solid var(--card-border);
      padding: 5px 8px;
      color: var(--text-muted);
      font-size: 10px;
      flex: 1 1 auto;
      width: 100%;
    }
    .thumbMemo{
      border-radius: 8px;
      background: var(--surface-3);
      border: 1px solid var(--card-border);
      padding: 8px;
      color: var(--text-muted);
      font-size: 10px;
    }
    .themeName{
      font-size: 14px;
      font-weight: 700;
      color: var(--text-strong);
      text-align: center;
    }
    .themeFooter{
      margin-top: 12px;
      padding-top: 8px;
      display:flex;
      justify-content: center;
      gap: 10px;
    }
    .themeFooter .btn{
      min-width: 220px;
      padding: 14px 18px;
      font-size: 14px;
      background: var(--btn-bg);
      border-color: var(--btn-border);
      color: var(--btn-fg);
    }
    /* stamp theme cards */
    .stampCard{
      border-radius: 12px;
      border: 1px solid var(--card-border);
      background: var(--card);
      padding: 10px;
      display:flex;
      flex-direction:column;
      gap: 6px;
      box-shadow: var(--card-shadow);
      cursor:pointer;
      transition: border-color .12s ease, transform .12s ease;
    }
    .stampCard:hover{ border-color: color-mix(in srgb, var(--accent) 70%, transparent); transform: translateY(-1px); }
    .stampCard.selected{ border-color: var(--accent); box-shadow: var(--shadow-md); }
    .stampThumb{
      height: 100px;
      border-radius: 10px;
      background: var(--surface-2);
      border: 1px solid var(--card-border);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 10px;
      box-shadow: inset 0 0 0 1px var(--border-subtle);
      position: relative;
    }
    .stampDotsRow{
      display:flex;
      gap: 12px;
      justify-content:center;
    }
    .stampPreviewDot{
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 2px solid var(--card-border);
      box-shadow: var(--shadow-stamp);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .stampPreviewDot .stampImg{ filter: drop-shadow(0 2px 6px color-mix(in srgb, var(--bg) 70%, transparent)); }

    .storeActions{
      margin-top: 6px;
      display:flex;
      gap: 8px;
    }
    .storeActions .btn{
      flex: 1 1 auto;
      padding: 8px 10px;
      font-size: 12px;
    }
    .storeOwned{
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: color-mix(in srgb, var(--bg) 70%, transparent);
      color: var(--text-strong);
      font-weight: 700;
      font-size: 12px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-shadow: 0 1px 2px color-mix(in srgb, var(--bg) 70%, transparent);
      pointer-events: none;
    }

    /* ===== menu ===== */
    .menuOverlay{
      position: fixed;
      inset: 0;
      background: color-mix(in srgb, var(--bg) 65%, transparent);
      backdrop-filter: blur(4px);
      display:none;
      z-index: 50;
    }
    .menuOverlay.show{ display:block; }

    .menuSheet{
      position: fixed;
      right: 14px;
      top: 74px;
      width: min(340px, calc(100vw - 28px), calc(820px - 28px));
      background: color-mix(in srgb, var(--panel) 94%, transparent);
      border: 1px solid var(--border-strong);
      border-radius: 16px;
      box-shadow: var(--shadow-popover);
      padding: 10px;
      display:none;
      z-index: 60;
    }
    @media (min-width: 900px){
      .menuSheet{
        right: calc((100vw - 820px)/2 - 14px);
      }
    }
    .menuSheet.show{ display:block; }

    .menuItem{
      width: 100%;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 10px;
      border-radius: 12px;
      background: var(--surface-3);
      border: 1px solid var(--border-subtle);
      color: var(--text);
      cursor:pointer;
      font-size: 14px;
      margin-bottom: 8px;
    }
    .menuItem:last-child{ margin-bottom:0; }
    .badge{ font-size: 12px; color: var(--muted); }

    /* ===== buttons ===== */
    .btn{
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 13px;
      cursor:pointer;
      min-width: 90px;
      box-shadow: var(--btn-shadow);
    }
    .btn.is-active{
      --btn-bg: var(--accent);
      --btn-border: var(--accent);
      --btn-fg: var(--text-strong);
      box-shadow: var(--shadow-md);
    }
    .btn:active{ transform: translateY(1px); }
    .btn.danger{
      border-color: var(--btn-danger-border);
      background: var(--btn-danger-bg);
      color: var(--btn-danger-fg);
      box-shadow: var(--btn-danger-shadow);
    }

    /* ===== diary + customize wrapper (slide) ===== */
    .diaryWrap{
      position: relative;
      margin-top: 12px;
      border-radius: 16px;
    }
    .slider{
      display:flex;
      width: 300%;
      transition: transform .22s ease;
      will-change: transform;
    }
    .slider.customize{ transform: translateX(-33.333%); }
    .slider.logDetail{ transform: translateX(-66.666%); }

    .panel{
      width: 33.333%;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 12px;
      box-shadow: var(--card-shadow);
      display:block;
      visibility: hidden;
      pointer-events: none;
      color: var(--text-strong);
    }
    .panel.show{
      visibility: visible;
      pointer-events: auto;
    }

    .diaryHead{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 10px;
    }
    .diaryHeadLeft{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .diaryStamp{
      width: 18px; height: 18px;
      border-radius: 999px;
      border: 2px solid var(--ring);
      background: transparent;
      flex: 0 0 auto;
      cursor: pointer;
      transition: transform .08s ease;
    }
    .diaryStamp:active{ transform: scale(.95); }
    .diaryStamp.filled{ border-color: var(--ring); box-shadow: var(--shadow-sm); }
    .diaryStamp.pink{ background: var(--pink); }
    .diaryStamp.orange{ background: var(--orange); }
    .diaryStamp.yellow{ background: var(--yellow); }
    .diaryStamp.green{ background: var(--green); }
    .diaryStamp.blue{ background: var(--blue); }

    .diaryLabel{ font-size: 12px; color: var(--muted); }
    .diaryDate{ font-size: 16px; font-weight: 700; letter-spacing: .02em; margin-top: 2px; }

    .headBtns{
      display:flex;
      gap: 8px;
      align-items:center;
    }

    .iconBtn{
      width: 38px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: var(--btn-shadow);
    }
    .iconBtn:active{ transform: translateY(1px); }
    .iconBtn svg{ width: 18px; height: 18px; opacity:.9; }

    .inlineConfirm{
      display:none;
      margin: 6px 0 10px;
      padding: 10px;
      border-radius: 14px;
      border: 1px solid var(--box-border);
      background: var(--box-bg);
      box-shadow: var(--box-shadow);
    }
    .inlineConfirm.show{ display:block; }
    .inlineConfirmMsg{
      font-size: 13px;
      color: var(--text-normal);
      margin-bottom: 10px;
      line-height: 1.5;
    }
    .inlineConfirmBtns{
      display:flex;
      gap: 10px;
      justify-content:flex-end;
    }

    .section{
      margin-top: 12px;
      padding-top: 10px;
      border-top: 1px solid var(--border-subtle);
    }
    .section:first-of-type{
      margin-top: 6px;
      padding-top: 0;
      border-top: none;
    }
    .sectionHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 8px;
    }
    .sectionTitle{ font-size: 12px; color: var(--muted); display:flex; align-items:center; gap:8px; }
    .chip{ display:none; }
    .diaryLogHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .diaryLogCount{ font-size: 12px; color: var(--text-mini); }
    .diaryLogBody{
      display:flex;
      flex-direction:column;
      gap: 6px;
      font-size: 13px;
      color: var(--text-normal);
    }
    .diaryLogEmpty{ color: var(--text-mini); }
    .diaryLogItem,
    .logDetailItem{
      display:flex;
      gap: 10px;
      align-items:center;
    }
    .diaryLogMemo{
      color: var(--text-mini);
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .diaryLogTime,
    .logDetailTime{
      font-variant-numeric: tabular-nums;
      color: var(--text-mini);
      min-width: 52px;
    }
    .logDetailList{
      display:flex;
      flex-direction:column;
      gap: 8px;
      font-size: 13px;
      color: var(--text-normal);
    }
    .diaryLogCount{ font-size: 12px; color: var(--text-mini); }
    .diaryLogBody{
      display:flex;
      flex-direction:column;
      gap: 6px;
      font-size: 13px;
      color: var(--text-normal);
    }
    .diaryLogEmpty{ color: var(--text-mini); }
    .diaryLogItem{
      display:flex;
      gap: 10px;
      align-items:center;
    }
    .diaryLogTime{
      font-variant-numeric: tabular-nums;
      color: var(--text-mini);
      min-width: 52px;
    }

    input.goal{
      width: 100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text-strong);
      outline: none;
      font-size: 16px;
      box-shadow: var(--input-shadow);
    }
    input.goal:focus{ border-color: color-mix(in srgb, var(--accent) 65%, transparent); }

    .todoList{ display:flex; flex-direction:column; gap: 8px; }
    .todoRow{
      display:flex;
      align-items:center;
      gap: 10px;
      position: relative;
      padding-right: 34px;
    }
    .todoRow input[type="checkbox"],
    .switch input[type="checkbox"]{
      width: 20px;
      height: 20px;
      flex: 0 0 auto;
      appearance: none;
      -webkit-appearance: none;
      border-radius: 6px;
      border: 1.5px solid var(--border-strong);
      background: var(--surface-3);
      box-shadow: var(--shadow-sm);
      display: inline-block;
      position: relative;
      cursor: pointer;
      transition: background .12s ease, border-color .12s ease, box-shadow .12s ease;
    }
    .todoRow input[type="checkbox"]::after,
    .switch input[type="checkbox"]::after{
      content: "";
      position: absolute;
      left: 5px;
      top: 2px;
      width: 6px;
      height: 10px;
      border: solid var(--text-strong);
      border-width: 0 2px 2px 0;
      transform: rotate(45deg) scale(0);
      transform-origin: center;
      transition: transform .12s ease;
    }
    .todoRow input[type="checkbox"]:checked,
    .switch input[type="checkbox"]:checked{
      background: linear-gradient(180deg, color-mix(in srgb, var(--accent) 96%, transparent), color-mix(in srgb, var(--accent) 80%, transparent));
      border-color: var(--accent);
      box-shadow: var(--shadow-sm);
    }
    .todoRow input[type="checkbox"]:checked::after,
    .switch input[type="checkbox"]:checked::after{
      transform: rotate(45deg) scale(1);
    }
    .todoRow input.todoText{
      flex: 1 1 auto;
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text-strong);
      outline: none;
      font-size: 14px;
      box-shadow: var(--input-shadow);
    }
    .todoRow input.todoText:focus{ border-color: color-mix(in srgb, var(--accent) 65%, transparent); }

    .todoDel{
      position:absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 28px;
      height: 28px;
      border-radius: 10px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      display:none;
      cursor:pointer;
    }
    .todoRow.showDel .todoDel{ display:block; }

    textarea.memo{
      width: 100%;
      min-height: 140px;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text-strong);
      outline: none;
      resize: vertical;
      line-height: 1.5;
      font-size: 14px;
      box-shadow: var(--input-shadow);
    }
    textarea.memo:focus{ border-color: color-mix(in srgb, var(--accent) 65%, transparent); }

    .hint{ color: var(--muted); font-size: 12px; margin-top: 10px; line-height: 1.6; }

    /* ===== Mood Widget (Diary) ===== */
    .moodWidget{
      margin-top: 12px;
      padding-top: 10px;
      border-top: 1px solid var(--border-subtle);
    }
    .moodTitle{
      font-size: 12px;
      color: var(--text-muted);
      letter-spacing: .02em;
      margin-bottom: 8px;
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .moodRow{
  display:flex;
  gap: 17px;                 /* スタンプ0.5個分（34pxの半分） */
  align-items:center;
  justify-content: flex-start; /* 左寄せ */
  padding: 8px 0 2px;
    }
    .moodPick{
      width: 34px;
      height: 34px;
      border-radius: 999px;
      border: 2px solid var(--ring);
      cursor:pointer;
      box-shadow: var(--shadow-stamp);
      transition: transform .08s ease, opacity .14s ease;
      background: transparent;
    }
    .moodPick:active{ transform: translateY(1px) scale(.98); }
    .moodPick.pink{ background: var(--pink); }
    .moodPick.orange{ background: var(--orange); }
    .moodPick.yellow{ background: var(--yellow); }
    .moodPick.green{ background: var(--green); }
    .moodPick.blue{ background: var(--blue); }
    .moodRow.hasSelection .moodPick{ opacity: .35; }
    .moodRow.hasSelection .moodPick.isSelected{ opacity: 1; outline: 2px solid var(--border-subtle); }

    /* ===== list ===== */
    .list{
      margin-top: 12px;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 12px;
      box-shadow: var(--card-shadow);
      display:none;
      color: var(--text-strong);
    }
    .list.show{ display:block; }

    .listHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .listTitle{ font-size: 14px; color: var(--muted); }

    .listItem{
      border-top: 1px solid var(--border-subtle);
      padding: 10px 0;
    }
    .listItem:first-of-type{ border-top: none; padding-top: 0; }

    .listItemHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 6px;
    }

    .listLeft{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }

    .miniStamp{
      width: 14px; height: 14px;
      border-radius: 999px;
      border: 2px solid var(--ring);
      background: transparent;
      flex: 0 0 auto;
    }
    .miniStamp.filled{ border-color: var(--ring); }
    .miniStamp.pink{ background: var(--pink); }
    .miniStamp.orange{ background: var(--orange); }
    .miniStamp.yellow{ background: var(--yellow); }
    .miniStamp.green{ background: var(--green); }
    .miniStamp.blue{ background: var(--blue); }

    .listDate{
      font-weight: 700;
      font-size: 14px;
      white-space: nowrap;
    }

    .preview{
      color: var(--text-normal);
      font-size: 13px;
      line-height: 1.5;
      opacity: .92;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .checkIcon{
      display:inline-block;
      width: 14px;
      height: 14px;
      border-radius: 4px;
      border: 1.5px solid var(--border-strong);
      background: var(--surface-3);
      margin-right: 6px;
      vertical-align: -2px;
      position: relative;
    }
    .checkIcon.todo{
      border-color: var(--border-strong);
    }
    .checkIcon.done{
      border-color: var(--accent);
      background: linear-gradient(180deg, color-mix(in srgb, var(--accent) 96%, transparent), color-mix(in srgb, var(--accent) 80%, transparent));
      box-shadow: var(--shadow-sm);
    }
    .checkIcon.done::after{
      content:"";
      position:absolute;
      left: 4px;
      top: 1px;
      width: 5px;
      height: 9px;
      border: solid var(--text-strong);
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
    .muted{ color: var(--muted); }

    /* ===== data ===== */
    .data{
      margin-top: 12px;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 12px;
      box-shadow: var(--card-shadow);
      display:none;
      color: var(--text-strong);
    }
    .data.show{ display:block; }

    .majorTitle{
      font-size: 12px;
      color: var(--muted);
      margin: 2px 0 8px;
      letter-spacing: .02em;
    }

    .kvRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 0;
      border-top: 1px solid var(--border-subtle);
    }
    .kvRow:first-of-type{ border-top:none; padding-top:0; }

    .kvLeft{
      display:flex;
      flex-direction:column;
      gap: 4px;
      min-width: 0;
    }
    .kvLabel{
      font-size: 13px;
      color: var(--text-normal);
    }
    .kvValueBig{
      font-size: 18px;
      font-weight: 800;
      letter-spacing: .02em;
      line-height: 1.2;
      white-space: nowrap;
    }

    .toggleBtn{
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      border-radius: 12px;
      padding: 9px 10px;
      font-size: 13px;
      cursor:pointer;
      white-space: nowrap;
      box-shadow: var(--btn-shadow);
    }
    .toggleBtn:active{ transform: translateY(1px); }

    .monthBreakdown{
      display:none;
      margin-top: 8px;
      padding: 10px;
      border-radius: 14px;
      border: 1px solid var(--box-border);
      background: var(--box-bg);
      box-shadow: var(--box-shadow);
    }
    .monthBreakdown.show{ display:block; }

    .monthLine{
      display:flex;
      justify-content:space-between;
      gap: 10px;
      padding: 6px 0;
      border-top: 1px solid var(--border-subtle);
      font-size: 13px;
      color: var(--text-normal);
    }
    .monthLine:first-child{ border-top:none; padding-top:0; }
    .monthLine span:last-child{ color: var(--muted); }

    .minorNote{
      font-size: 12px;
      color: var(--muted);
      line-height: 1.6;
      margin-top: 8px;
    }

    .row{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items:center;
      justify-content:space-between;
      padding: 10px 0;
      border-top: 1px solid var(--border-subtle);
    }
    .row:first-of-type{ border-top:none; padding-top:0; }
    .rowLabel{
      min-width: 220px;
      font-size: 13px;
      color: var(--text-normal);
    }
    .controls{
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap: wrap;
      justify-content:flex-end;
    }
    select{
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text);
      outline: none;
      font-size: 13px;
    }
    input[type="file"]{
      color: var(--muted);
      font-size: 12px;
    }

    .divider{
      margin: 14px 0;
      border-top: 1px solid var(--border-subtle);
    }

    /* ===== customize panel ===== */
    .customHead{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      margin-bottom: 10px;
    }
    .customTitle{
      font-size: 16px;
      font-weight: 800;
      letter-spacing: .02em;
    }
    .customSub{
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
      line-height: 1.6;
    }

    .blockList{
      display:flex;
      flex-direction:column;
      gap: 10px;
      margin-top: 10px;
    }
    .blockCard{
      border-radius: 14px;
      border: 1px solid var(--box-border);
      background: var(--box-bg);
      padding: 10px;
    }
    .blockCard.is-touched{
      border-color: var(--accent);
      box-shadow: var(--shadow-sm);
    }
    .blockTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .blockName{
      display:flex;
      align-items:center;
      gap: 8px;
      min-width: 0;
    }
    .blockName strong{
      font-size: 13px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display:block;
      max-width: 240px;
    }
    .lockTag{
      font-size: 11px;
      color: var(--text-normal);
      border: 1px solid var(--pill-border);
      background: var(--pill-bg);
      padding: 3px 8px;
      border-radius: 999px;
      white-space: nowrap;
    }

    .blockActions{
      display:flex;
      align-items:center;
      gap: 8px;
    }

    .tinyBtn{
      width: 34px;
      height: 30px;
      border-radius: 12px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 13px;
      box-shadow: var(--btn-shadow);
    }
    .tinyBtn[disabled]{ opacity: .35; cursor: default; }
    .tinyBtn:active{ transform: translateY(1px); }

    .blockBottom{
      margin-top: 8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .switch{
      display:flex;
      align-items:center;
      gap: 8px;
      color: var(--text-normal);
      font-size: 12px;
    }
    .switch input{ width: 18px; height: 18px; }

    .renameRow{
      display:none;
      margin-top: 10px;
      gap: 10px;
      align-items:center;
    }
    .renameRow.show{ display:flex; }
    .renameRow input{
      flex: 1 1 auto;
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text);
      outline:none;
      font-size: 13px;
    }

    .customFooter{
      margin-top: 14px;
      display:flex;
      gap: 10px;
      justify-content: space-between;
      align-items:center;
    }
    .ghostBtn{
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 13px;
      cursor:pointer;
      min-width: 120px;
      box-shadow: var(--btn-shadow);
    }
    .ghostBtn:active{ transform: translateY(1px); }

    /* ===== view mode helpers ===== */
    .hidden { display: none !important; }

    /* ===== responsive ===== */
    @media (max-width: 640px){
      .wrap{ padding-bottom: 22px; }
      .dow{ padding: 8px 8px 0; gap: 6px; }
      .grid{ padding: 8px; }
      .days{ gap: 6px; padding-top: 8px; }

      .cell{
        height: auto;
        aspect-ratio: 1 / 1.07;
        padding: 7px;
      }
      .dot{ width: var(--stamp-m); height: var(--stamp-m); right: 7px; bottom: 7px; }

      .grid.calendarPanel{ max-height: 72vh; }
      .moodPick{ width: var(--stamp-l); height: var(--stamp-l); }
    }

    @media (min-width: 760px){
      .goalPreview{ display:none; }
      .goalPreview.show{ display:-webkit-box; }
      .cell{ height: 96px; }
    }

    /* ===== stamp sizing (S/M/L) ===== */
    :root{
      --stamp-s: 16px;
      --stamp-m: 24px;
      --stamp-l: 28px;
    }
    .dot,
    .diaryStamp,
    .moodPick,
    .miniStamp,
    .stampPreviewDot,
    .thumbMoodDot,
    .thumbDiaryStamp{
      display: grid;
      place-items: center;
      overflow: hidden;
      box-sizing: border-box;
      padding: 0;
    }
    .imgStamp{
      border: none !important;
      background: transparent !important;
      box-shadow: none !important;
      border-radius: 0 !important;
      overflow: visible !important;
      padding: 0 !important;
    }
    .maskStamp{
      border: none !important;
      box-shadow: none !important;
      border-radius: 0 !important;
      overflow: visible !important;
      padding: 0 !important;
    }
    .imgStamp .stampImg{
      filter: drop-shadow(0 3px 8px color-mix(in srgb, var(--bg) 70%, transparent));
    }
    .thumbDayStamp,
    .thumbDiaryStamp,
    .miniStamp,
    .diaryStamp{
      width: var(--stamp-s);
      height: var(--stamp-s);
    }
    /* M */
    .pick{
      width: var(--stamp-s);
      height: var(--stamp-s);
    }
    .dot,
    .thumbMoodDot{
      width: var(--stamp-m);
      height: var(--stamp-m);
    }
    .moodPick{
      width: var(--stamp-l);
      height: var(--stamp-l);
    }

    /* ===== store ===== */
    .store{ display:none; }
    .store.show{ display:block; }
    .storeHead{ display:flex; justify-content:space-between; align-items:flex-end; margin: 8px 0 14px; }
    .storeTitle{ font-size: 20px; font-weight: 700; letter-spacing: .02em; }
    .storeSub{ font-size: 12px; color: var(--muted); }
    .storeStatus{ color: var(--muted); font-size: 13px; margin-bottom: 10px; }
    /* L */
    .stampPreviewDot{
      width: var(--stamp-l);
      height: var(--stamp-l);
    }
  
    /* ===== light theme overrides ===== */
    :root[data-ui-theme="ui_light_default"] body{
      background: var(--bg);
    }
    :root[data-ui-theme="ui_light_default"] header{
      background: color-mix(in srgb, var(--surface-1) 90%, transparent);
      border-bottom: 1px solid var(--border-subtle);
      color: var(--text-strong);
    }
    :root[data-ui-theme="ui_light_default"] .wrap{
      color: var(--text-strong);
    }
    :root[data-ui-theme="ui_light_default"] .grid,
    :root[data-ui-theme="ui_light_default"] .panel,
    :root[data-ui-theme="ui_light_default"] .list,
    :root[data-ui-theme="ui_light_default"] .data{
      border: 1px solid var(--card-border);
      box-shadow: var(--card-shadow);
      background: var(--card);
      color: var(--text-strong);
    }
    :root[data-ui-theme="ui_light_default"] .menuSheet,
    :root[data-ui-theme="ui_light_default"] .themePanel{
      background: color-mix(in srgb, var(--surface-1) 98%, transparent);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-popover);
      color: var(--text-strong);
    }
    :root[data-ui-theme="ui_light_default"] .menuItem{
      background: var(--surface-3);
      border: 1px solid var(--border-subtle);
      color: var(--text-strong);
    }
    :root[data-ui-theme="ui_light_default"] .badge,
    :root[data-ui-theme="ui_light_default"] .muted,
    :root[data-ui-theme="ui_light_default"] .themeSub,
    :root[data-ui-theme="ui_light_default"] .sub,
    :root[data-ui-theme="ui_light_default"] .hint,
    :root[data-ui-theme="ui_light_default"] .minorNote,
    :root[data-ui-theme="ui_light_default"] .moodTitle,
    :root[data-ui-theme="ui_light_default"] .pickerTitle{
      color: var(--text-muted);
    }
    :root[data-ui-theme="ui_light_default"] .listDate,
    :root[data-ui-theme="ui_light_default"] .preview,
    :root[data-ui-theme="ui_light_default"] .goalPreview,
    :root[data-ui-theme="ui_light_default"] .daynum{
      color: var(--text-strong);
    }
    :root[data-ui-theme="ui_light_default"] .navBtn,
    :root[data-ui-theme="ui_light_default"] .hamburger,
    :root[data-ui-theme="ui_light_default"] .iconBtn,
    :root[data-ui-theme="ui_light_default"] .btn,
    :root[data-ui-theme="ui_light_default"] .ghostBtn,
    :root[data-ui-theme="ui_light_default"] .toggleBtn,
    :root[data-ui-theme="ui_light_default"] .tinyBtn,
    :root[data-ui-theme="ui_light_default"] .todoRow .todoDel{
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-fg);
      box-shadow: var(--btn-shadow);
    }
    :root[data-ui-theme="ui_light_default"] .btn.danger{
      border-color: var(--btn-danger-border);
      background: var(--btn-danger-bg);
      color: var(--btn-danger-fg);
      box-shadow: var(--btn-danger-shadow);
    }
    :root[data-ui-theme="ui_light_default"] .hamburger span{
      background: color-mix(in srgb, var(--text-strong) 85%, transparent);
    }
    :root[data-ui-theme="ui_light_default"] input.goal,
    :root[data-ui-theme="ui_light_default"] .todoRow input.todoText,
    :root[data-ui-theme="ui_light_default"] textarea.memo,
    :root[data-ui-theme="ui_light_default"] select,
    :root[data-ui-theme="ui_light_default"] input[type="file"]{
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      color: var(--text-strong);
      box-shadow: var(--input-shadow);
    }
    :root[data-ui-theme="ui_light_default"] input.goal:focus,
    :root[data-ui-theme="ui_light_default"] .todoRow input.todoText:focus,
    :root[data-ui-theme="ui_light_default"] textarea.memo:focus{
      border-color: color-mix(in srgb, var(--accent) 65%, transparent);
      box-shadow: var(--shadow-sm);
    }
    :root[data-ui-theme="ui_light_default"] .picker{
      background: var(--card);
      border: 1px solid var(--card-border);
      color: var(--text-strong);
      box-shadow: var(--shadow-popover);
    }
    :root[data-ui-theme="ui_light_default"] .caret{
      background: var(--card);
      border-left: 1px solid var(--card-border);
      border-top: 1px solid var(--card-border);
      box-shadow: var(--shadow-popover);
    }
    :root[data-ui-theme="ui_light_default"] .panel,
    :root[data-ui-theme="ui_light_default"] .list,
    :root[data-ui-theme="ui_light_default"] .data{
      background: var(--card);
    }
    :root[data-ui-theme="ui_light_default"] .blockCard{
      background: var(--card);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-sm);
    }
    :root[data-ui-theme="ui_light_default"] .blockCard.is-touched{
      border-color: var(--accent);
      box-shadow: var(--shadow-sm);
    }
    :root[data-ui-theme="ui_light_default"] .blockTop,
    :root[data-ui-theme="ui_light_default"] .blockBottom,
    :root[data-ui-theme="ui_light_default"] .switch span,
    :root[data-ui-theme="ui_light_default"] .renameRow input,
    :root[data-ui-theme="ui_light_default"] .majorTitle,
    :root[data-ui-theme="ui_light_default"] .kvLabel,
    :root[data-ui-theme="ui_light_default"] .rowLabel{
      color: var(--text-normal);
    }
    :root[data-ui-theme="ui_light_default"] .renameRow input{
      border: 1px solid var(--input-border);
      box-shadow: var(--input-shadow);
      background: var(--input-bg);
    }
    :root[data-ui-theme="ui_light_default"] .switch input[type="checkbox"]{
      box-shadow: var(--shadow-sm);
    }
    :root[data-ui-theme="ui_light_default"] .lockTag,
    :root[data-ui-theme="ui_light_default"] .chip{
      color: var(--pill-fg);
      border: 1px solid var(--pill-border);
      background: var(--pill-bg);
    }
    :root[data-ui-theme="ui_light_default"] .themePanel{
      color: var(--text-strong);
    }
